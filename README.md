# KG-CLDDI

## Overview

This repository contains source code for our paper "A knowledge graph-based method for drug-drug interaction prediction with contrastive learning".

We design a multi-stage feature extraction process that adeptly extracts drug-related features from the knowledge graph and construct the contrastive learning module using a multi-modal data augmentation strategy to generate high-quality embeddings for drug-drug pairs. 

## Requirements

* Python == 3.7.3
* Pytorch == 1.8.1
* CUDA == 11.1
* pandas == 1.3.0
* scikit-learn == 0.23.2
  
## Pretrain your data Preparation

For multi-label DDI prediction, you need to unzip the compressed file in the ./data/TwoSides folder. For multi-label DDI prediction, you need to unzip the compressed file in the ./data/Drugbank folder.
* multi_ddi_sift.txtï¼šThe total multi-class dataset.
* MUltiClass_TrainAll_S1.csv: The training dataset of the S1 Partition Scheme.
* MUltiClass_Test_S1.csv: The test set of the S1 Partition Scheme.
* MUltiClass_Train_S1.csv: The training dataset of the S2 Partition Scheme.
* MUltiClass_Test_S2.csv: The test set of the S2 Partition Scheme.
  
Note that the knowledge graph dataset and the initial embedding data generated by pre-training are placed in the ./data/TwoSides folder.

## Files:


## Running the code

You can run the following command to re-implement our work:

For multi-label DDI prediction, in the ./multilabel folder; for multi-class DDI prediction, in the ./multiclass folder:

* > python main.py

## Contact
If you have any questions or suggestions with the code, please let us know. Contact Zhong Jian at jianzhong@csu.edu.cn
